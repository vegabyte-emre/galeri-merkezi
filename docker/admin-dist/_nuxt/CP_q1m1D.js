import{d as K,i as g,l as M,e as l,a as e,x as v,b as P,h as S,u as A,F as y,r as x,A as E,t as d,m as _,q as R,o as i,n as Y}from"./DhZVrtZb.js";import{u as p}from"./B0egXiWe.js";import{u as j}from"./ZU3_NlSd.js";import{P as B}from"./Cht4xMKM.js";import"./BBSYxXC8.js";const N={class:"space-y-6"},H={class:"flex items-center justify-between"},T={class:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},F={class:"flex items-center justify-between mb-4"},U={class:"text-lg font-bold text-gray-900 dark:text-white"},q={class:"text-sm text-gray-500 dark:text-gray-400"},L={key:0,class:"px-2 py-1 text-xs font-semibold rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400"},O={class:"mb-4"},J={class:"text-2xl font-bold text-gray-900 dark:text-white"},Q={class:"mb-4"},W={class:"text-xl font-bold text-gray-900 dark:text-white"},X={class:"flex items-center gap-2 pt-4 border-t border-gray-200 dark:border-gray-700"},Z=["onClick"],I=["onClick"],ee={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 p-6"},te={class:"overflow-x-auto"},ae={class:"w-full"},re={class:"bg-gray-50 dark:bg-gray-700/50"},se={class:"divide-y divide-gray-200 dark:divide-gray-700"},le={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},ie=["checked","onChange"],oe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full p-6"},ne={class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},de={class:"space-y-4"},ue={class:"flex items-center justify-end gap-3 mt-6"},be=K({__name:"roles",setup(ce){const k=p(),u=j(),f=g(!1),m=g([]),o=g([]),h=async()=>{f.value=!0;try{const r=await k.get("/roles");o.value=r.roles||r||[]}catch(r){console.error("Roller yüklenemedi:",r),u.error("Roller yüklenemedi: "+r.message)}finally{f.value=!1}},C=async()=>{try{const r=await k.get("/roles/permissions");m.value=r.permissions||r||[]}catch(r){console.error("İzinler yüklenemedi:",r),m.value=[{id:1,name:"Galerileri Görüntüle"},{id:2,name:"Galerileri Düzenle"},{id:3,name:"Galerileri Sil"},{id:4,name:"Kullanıcıları Görüntüle"},{id:5,name:"Kullanıcıları Düzenle"},{id:6,name:"Kullanıcıları Sil"},{id:7,name:"Raporları Görüntüle"},{id:8,name:"Sistem Ayarları"},{id:9,name:"Yedekleme Yönetimi"},{id:10,name:"Entegrasyon Yönetimi"}]}},z=async(r,t)=>{const a=o.value.find(n=>n.id===r);if(a){const n=a.permissions.indexOf(t),b=n>-1;try{await p().put(`/roles/${r}/permissions`,{permissionId:t,enabled:!b}),b?a.permissions.splice(n,1):a.permissions.push(t)}catch(w){u.error("Hata: "+w.message)}}},c=g(!1),s=g(null),D=()=>{s.value={name:"",description:"",permissions:[],isDefault:!1},c.value=!0},$=r=>{const t=o.value.find(a=>a.id===r);t&&(s.value={...t},c.value=!0)},V=async()=>{if(!s.value?.name){u.error("Rol adı gereklidir");return}try{const r=p();if(s.value.id){await r.put(`/roles/${s.value.id}`,s.value);const t=o.value.findIndex(a=>a.id===s.value.id);t>-1&&(o.value[t]={...s.value})}else{const t=await r.post("/roles",s.value);o.value.push(t)}c.value=!1,s.value=null,u.success("Rol kaydedildi!"),await h()}catch(r){u.error("Hata: "+r.message)}},G=async r=>{if(confirm("Bu rolü silmek istediğinize emin misiniz?"))try{await p().delete(`/roles/${r}`),o.value=o.value.filter(a=>a.id!==r),u.success("Rol silindi!")}catch(t){u.error("Hata: "+t.message)}};return M(()=>{h(),C()}),(r,t)=>(i(),l("div",N,[e("div",H,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Roller & İzinler"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Kullanıcı rollerini ve izinlerini yönetin")],-1)),e("button",{onClick:D,class:"px-4 py-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-lg hover:shadow-lg transition-all"},[P(A(B),{class:"w-4 h-4 inline mr-2"}),t[4]||(t[4]=S(" Yeni Rol Ekle ",-1))])]),e("div",T,[(i(!0),l(y,null,x(o.value,a=>(i(),l("div",{key:a.id,class:Y(["bg-white dark:bg-gray-800 rounded-2xl shadow-lg border-2 p-6",a.isDefault?"border-primary-500":"border-gray-200 dark:border-gray-700"])},[e("div",F,[e("div",null,[e("h3",U,d(a.name),1),e("p",q,d(a.description),1)]),a.isDefault?(i(),l("span",L," Varsayılan ")):v("",!0)]),e("div",O,[t[6]||(t[6]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"İzinler",-1)),e("div",J,d(a.permissions.length)+" / "+d(m.value.length),1)]),e("div",Q,[t[7]||(t[7]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Kullanıcı Sayısı",-1)),e("div",W,d(a.userCount),1)]),e("div",X,[e("button",{onClick:n=>$(a.id),class:"flex-1 px-4 py-2 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-900/50 transition-colors font-semibold text-sm"}," Düzenle ",8,Z),a.isDefault?v("",!0):(i(),l("button",{key:0,onClick:n=>G(a.id),class:"px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors font-semibold text-sm"}," Sil ",8,I))])],2))),128))]),e("div",ee,[t[9]||(t[9]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-4"},"İzin Matrisi",-1)),e("div",te,[e("table",ae,[e("thead",re,[e("tr",null,[t[8]||(t[8]=e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},"İzin",-1)),(i(!0),l(y,null,x(o.value,a=>(i(),l("th",{key:a.id,class:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},d(a.name),1))),128))])]),e("tbody",se,[(i(!0),l(y,null,x(m.value,a=>(i(),l("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",le,d(a.name),1),(i(!0),l(y,null,x(o.value,n=>(i(),l("td",{key:n.id,class:"px-4 py-3 text-center"},[e("input",{type:"checkbox",checked:n.permissions.includes(a.id),onChange:b=>z(n.id,a.id),class:"rounded"},null,40,ie)]))),128))]))),128))])])])]),c.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t[3]||(t[3]=E(a=>{c.value=!1,s.value=null},["self"]))},[e("div",oe,[e("h3",ne,d(s.value?.id?"Rol Düzenle":"Yeni Rol Ekle"),1),e("div",de,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Rol Adı ",-1)),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.value.name=a),type:"text",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Rol adı"},null,512),[[R,s.value.name]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Açıklama ",-1)),_(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.description=a),rows:"3",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Rol açıklaması"},null,512),[[R,s.value.description]])])]),e("div",ue,[e("button",{onClick:t[2]||(t[2]=a=>{c.value=!1,s.value=null}),class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," İptal "),e("button",{onClick:V,class:"px-4 py-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-lg hover:shadow-lg transition-all"}," Kaydet ")])])])):v("",!0)]))}});export{be as default};
