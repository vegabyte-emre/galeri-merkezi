import{d as V,i as c,k as w,l as F,e as g,a as e,b as G,h as M,u as O,t as d,n as m,x as _,m as k,J as U,v as H,q as L,F as q,r as N,o as y}from"./DhZVrtZb.js";import{u}from"./B0egXiWe.js";import{u as R}from"./ZU3_NlSd.js";import{D as j}from"./P61tqC2B.js";import"./BBSYxXC8.js";const E={class:"space-y-6"},K={class:"flex items-center justify-between"},J=["disabled"],P={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},I={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},Q={class:"text-3xl font-bold text-gray-900 dark:text-white"},W={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},X={class:"text-3xl font-bold text-gray-900 dark:text-white"},Z={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},ee={class:"text-lg font-bold text-gray-900 dark:text-white"},te={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},re={class:"text-lg font-bold text-gray-900 dark:text-white"},ae={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 p-6"},se={class:"flex items-center justify-between mb-4"},oe={class:"relative inline-flex items-center cursor-pointer"},le={key:0,class:"grid grid-cols-2 gap-4"},de={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700"},ie={class:"overflow-x-auto"},ne={class:"w-full"},ce={class:"divide-y divide-gray-200 dark:divide-gray-700"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},ye={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4 whitespace-nowrap"},xe={class:"px-6 py-4 whitespace-nowrap"},be={class:"flex items-center gap-2"},me=["onClick"],ke=["onClick"],fe=["onClick"],ze=V({__name:"backup",setup(ve){const B=u(),s=R(),p=c(!1),i=c(!0),x=c("daily"),b=c("02:00"),f=c(!1),o=c([]),v=async()=>{f.value=!0;try{const r=await B.get("/backup");o.value=r.backups||r||[],r.schedule&&(i.value=r.schedule.enabled||!1,x.value=r.schedule.frequency||"daily",b.value=r.schedule.time||"02:00")}catch(r){console.error("Yedeklemeler yüklenemedi:",r),s.error("Yedeklemeler yüklenemedi: "+(r.message||"Bilinmeyen hata"))}finally{f.value=!1}},Y=w(()=>{if(o.value.length===0)return"0 GB";const r=o.value.reduce((t,a)=>{const l=a.size||"0 GB",n=parseFloat(l),D=l.includes("MB")?1024:l.includes("GB")?1024*1024:1;return t+n*D},0);return r>=1024*1024?`${(r/(1024*1024)).toFixed(1)} GB`:r>=1024?`${(r/1024).toFixed(1)} MB`:`${r.toFixed(1)} KB`}),z=w(()=>o.value.length===0?"Henüz yok":h(o.value[0].createdAt)),h=r=>new Date(r).toLocaleString("tr-TR"),C=async()=>{p.value=!0;try{const t=await u().post("/backup/create");o.value.unshift({id:t.id,createdAt:t.createdAt,size:t.size,type:"manual",status:"completed"}),s.success("Yedekleme başarıyla oluşturuldu!"),await v()}catch(r){s.error("Hata: "+r.message)}finally{p.value=!1}},T=async r=>{try{const a=await u().get(`/backup/${r}/download`,{responseType:"blob"}),l=window.URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download=`backup-${r}.sql`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(l),s.success("Yedekleme indirildi!")}catch(t){s.error("İndirme başarısız: "+t.message)}},S=async r=>{if(confirm("Bu yedeklemeyi geri yüklemek istediğinize emin misiniz? Bu işlem mevcut verileri değiştirecektir."))try{await u().post(`/backup/${r}/restore`),s.success("Yedekleme geri yüklendi!")}catch(t){alert("Hata: "+t.message)}},$=async r=>{if(confirm("Bu yedeklemeyi silmek istediğinize emin misiniz?"))try{await u().delete(`/backup/${r}`),o.value=o.value.filter(a=>a.id!==r),s.success("Yedekleme silindi!")}catch(t){s.error("Hata: "+t.message)}},A=async()=>{try{await u().put("/backup/schedule",{enabled:i.value,frequency:x.value,time:b.value}),s.success("Yedekleme ayarları kaydedildi!")}catch(r){s.error("Hata: "+r.message)}};return F(()=>{v()}),(r,t)=>(y(),g("div",E,[e("div",K,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Yedekleme & Geri Yükleme"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Veritabanı yedeklemelerini yönetin")],-1)),e("button",{onClick:C,disabled:p.value,class:"px-4 py-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[G(O(j),{class:"w-4 h-4 inline mr-2"}),M(" "+d(p.value?"Yedekleme Oluşturuluyor...":"Yeni Yedekleme Oluştur"),1)],8,J)]),e("div",P,[e("div",I,[t[4]||(t[4]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Toplam Yedekleme",-1)),e("div",Q,d(o.value.length),1)]),e("div",W,[t[5]||(t[5]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Toplam Boyut",-1)),e("div",X,d(Y.value),1)]),e("div",Z,[t[6]||(t[6]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Son Yedekleme",-1)),e("div",ee,d(z.value),1)]),e("div",te,[t[7]||(t[7]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Otomatik Yedekleme",-1)),e("div",re,[e("span",{class:m(i.value?"text-green-600 dark:text-green-400":"text-gray-400")},d(i.value?"Aktif":"Pasif"),3)])])]),e("div",ae,[e("div",se,[t[9]||(t[9]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Otomatik Yedekleme Ayarları",-1)),e("label",oe,[k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a),type:"checkbox",class:"sr-only peer"},null,512),[[U,i.value]]),t[8]||(t[8]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary-600"},null,-1))])]),i.value?(y(),g("div",le,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Yedekleme Sıklığı ",-1)),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>x.value=a),class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[...t[10]||(t[10]=[e("option",{value:"daily"},"Günlük",-1),e("option",{value:"weekly"},"Haftalık",-1),e("option",{value:"monthly"},"Aylık",-1)])],512),[[H,x.value]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Yedekleme Saati ",-1)),k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>b.value=a),type:"time",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[L,b.value]])])])):_("",!0),i.value?(y(),g("button",{key:1,onClick:A,class:"mt-4 px-4 py-2 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-900/50 transition-colors font-semibold"}," Ayarları Kaydet ")):_("",!0)]),e("div",de,[t[14]||(t[14]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Yedeklemeler")],-1)),e("div",ie,[e("table",ne,[t[13]||(t[13]=e("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},"Tarih"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},"Boyut"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},"Tip"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},"Durum"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase"},"İşlemler")])],-1)),e("tbody",ce,[(y(!0),g(q,null,N(o.value,a=>(y(),g("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("td",ue,d(h(a.createdAt)),1),e("td",ge,d(a.size),1),e("td",ye,[e("span",{class:m(["px-2 py-1 text-xs font-semibold rounded-full",a.type==="manual"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400"])},d(a.type==="manual"?"Manuel":"Otomatik"),3)]),e("td",pe,[e("span",{class:m(["px-2 py-1 text-xs font-semibold rounded-full",a.status==="completed"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400"])},d(a.status==="completed"?"Tamamlandı":"İşleniyor"),3)]),e("td",xe,[e("div",be,[e("button",{onClick:l=>T(a.id),class:"px-3 py-1.5 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-900/50 transition-colors font-semibold text-xs"}," İndir ",8,me),e("button",{onClick:l=>S(a.id),class:"px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors font-semibold text-xs"}," Geri Yükle ",8,ke),e("button",{onClick:l=>$(a.id),class:"px-3 py-1.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors font-semibold text-xs"}," Sil ",8,fe)])])]))),128))])])])])]))}});export{ze as default};
