import{d as B,p as u,s as v,v as E,e as d,a as e,C as f,b as L,h as j,u as Y,t as s,F as T,r as A,E as $,x as i,y as m,A as w,I as F,o as n,n as C}from"./4jj4Bu4Q.js";import{u as K}from"./D0_PazS5.js";import{u as R}from"./oAyxGMvK.js";import{P as H}from"./C5Gqy1km.js";import"./VCcvzI2M.js";const O={class:"space-y-6"},q={class:"flex items-center justify-between"},J={class:"flex items-center gap-3"},Q={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},W={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},X={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},Z={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},ee={class:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1"},te={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},ae={class:"text-2xl font-bold text-red-600 dark:text-red-400 mt-1"},re={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},le={class:"text-2xl font-bold text-primary-600 dark:text-primary-400 mt-1"},se={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},oe={class:"overflow-x-auto"},de={class:"w-full"},ie={class:"divide-y divide-gray-200 dark:divide-gray-700"},ne={class:"px-6 py-4 whitespace-nowrap"},ge={class:"flex items-center gap-3"},ye={class:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-semibold"},ue={class:"font-medium text-gray-900 dark:text-white"},xe={class:"text-sm text-gray-500 dark:text-gray-400"},pe={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ke={class:"px-6 py-4 whitespace-nowrap"},ve={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},fe={class:"flex items-center justify-end gap-2"},we=["onClick"],he=["onClick"],De={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto"},_e={class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},Te={class:"space-y-4"},Ae=["value"],Ce={class:"grid grid-cols-2 gap-4"},Se={class:"grid grid-cols-2 gap-4"},Ve={class:"flex items-center gap-2"},Ie={key:0},Ne={class:"flex items-center justify-end gap-3 mt-6"},Ee=B({__name:"subscriptions",setup(ze){const x=K(),g=R(),h=u(!1),b=u(!1),y=u(!1),o=u([]),D=u([]),l=u({galleryId:null,plan:"basic",paymentType:"monthly",startDate:"",endDate:"",isTrial:!1,trialDays:30,status:"active"}),S={basic:"Temel",premium:"Premium",enterprise:"Kurumsal"},V={active:"Aktif",expired:"Süresi Dolmuş",trial:"Deneme",cancelled:"İptal Edilmiş"},I=v(()=>o.value.filter(r=>r.status==="active").length),N=v(()=>o.value.filter(r=>r.status==="expired").length),z=v(()=>o.value.filter(r=>r.status==="active"&&r.paymentType==="monthly").reduce((r,t)=>r+({basic:500,premium:1500,enterprise:3e3}[t.plan]||0),0)),c=async()=>{h.value=!0;try{const r=await x.get("/subscriptions");o.value=r.subscriptions||r||[]}catch(r){console.error("Abonelikler yüklenemedi:",r),g.error("Abonelikler yüklenemedi: "+r.message)}finally{h.value=!1}},G=async()=>{try{const r=await x.get("/galleries");D.value=r.galleries||r||[]}catch(r){console.error("Galeriler yüklenemedi:",r)}},U=r=>{l.value={galleryId:r.galleryId,plan:r.plan,paymentType:r.paymentType,startDate:r.startDate.split("T")[0],endDate:r.endDate.split("T")[0],isTrial:r.status==="trial",trialDays:r.trialDays||30,status:r.status},y.value=!0},M=async r=>{if(!o.value.find(p=>p.id===r))return;const a=prompt("Kaç gün uzatmak istiyorsunuz?","30");if(!(!a||isNaN(Number(a))))try{await x.post(`/subscriptions/${r}/extend-trial`,{days:Number(a)}),g.success("Deneme süresi uzatıldı!"),await c()}catch(p){g.error("Hata: "+p.message)}},P=async()=>{if(!l.value.galleryId){g.warning("Lütfen bir galeri seçin");return}try{if(y.value){const r=o.value.find(t=>t.galleryId===l.value.galleryId);r&&(await x.put(`/subscriptions/${r.id}`,l.value),g.success("Abonelik güncellendi!"))}else await x.post("/subscriptions",l.value),g.success("Abonelik oluşturuldu!");k(),await c()}catch(r){g.error("Hata: "+r.message)}},k=()=>{b.value=!1,y.value=!1,l.value={galleryId:null,plan:"basic",paymentType:"monthly",startDate:"",endDate:"",isTrial:!1,trialDays:30,status:"active"}},_=r=>new Date(r).toLocaleDateString("tr-TR");return E(()=>{c(),G()}),(r,t)=>(n(),d("div",O,[e("div",q,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Abonelik Yönetimi"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Galeri aboneliklerini yönetin ve ödemeleri takip edin")],-1)),e("div",J,[e("button",{onClick:t[0]||(t[0]=a=>b.value=!0),class:"px-4 py-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-lg hover:shadow-lg transition-all"},[L(Y(H),{class:"w-4 h-4 inline mr-2"}),t[9]||(t[9]=j(" Yeni Abonelik ",-1))])])]),e("div",Q,[e("div",W,[t[11]||(t[11]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Toplam Abonelik",-1)),e("div",X,s(o.value.length),1)]),e("div",Z,[t[12]||(t[12]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Aktif Abonelik",-1)),e("div",ee,s(I.value),1)]),e("div",te,[t[13]||(t[13]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Süresi Dolan",-1)),e("div",ae,s(N.value),1)]),e("div",re,[t[14]||(t[14]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Aylık Gelir",-1)),e("div",le,"₺"+s(z.value.toLocaleString("tr-TR")),1)])]),e("div",se,[e("div",oe,[e("table",de,[t[15]||(t[15]=e("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"Galeri"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"Plan"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"Ödeme Tipi"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"Başlangıç"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"Bitiş"),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"Durum"),e("th",{class:"px-6 py-3 text-right text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider"},"İşlemler")])],-1)),e("tbody",ie,[(n(!0),d(T,null,A(o.value,a=>(n(),d("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("td",ne,[e("div",ge,[e("div",ye,s(a.galleryName.charAt(0)),1),e("div",null,[e("div",ue,s(a.galleryName),1),e("div",xe,s(a.galleryEmail),1)])])]),e("td",pe,[e("span",{class:C(["px-2 py-1 text-xs font-semibold rounded-full",{"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":a.plan==="basic","bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":a.plan==="premium","bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":a.plan==="enterprise"}])},s(S[a.plan]),3)]),e("td",me,s(a.paymentType==="monthly"?"Aylık":"Yıllık"),1),e("td",be,s(_(a.startDate)),1),e("td",ce,s(_(a.endDate)),1),e("td",ke,[e("span",{class:C(["px-2 py-1 text-xs font-semibold rounded-full",{"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":a.status==="active","bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":a.status==="expired","bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":a.status==="trial","bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-400":a.status==="cancelled"}])},s(V[a.status]),3)]),e("td",ve,[e("div",fe,[e("button",{onClick:p=>U(a),class:"px-3 py-1.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors text-xs font-semibold"}," Düzenle ",8,we),a.status==="active"?(n(),d("button",{key:0,onClick:p=>M(a.id),class:"px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors text-xs font-semibold"}," Süre Uzat ",8,he)):f("",!0)])])]))),128))])])])]),b.value||y.value?(n(),d("div",{key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:$(k,["self"])},[e("div",De,[e("h3",_e,s(y.value?"Abonelik Düzenle":"Yeni Abonelik Oluştur"),1),e("div",Te,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Galeri ",-1)),i(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.galleryId=a),class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t[16]||(t[16]=e("option",{value:""},"Galeri Seçin",-1)),(n(!0),d(T,null,A(D.value,a=>(n(),d("option",{key:a.id,value:a.id},s(a.name),9,Ae))),128))],512),[[m,l.value.galleryId]])]),e("div",Ce,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Plan ",-1)),i(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.plan=a),class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[...t[18]||(t[18]=[e("option",{value:"basic"},"Temel",-1),e("option",{value:"premium"},"Premium",-1),e("option",{value:"enterprise"},"Kurumsal",-1)])],512),[[m,l.value.plan]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Ödeme Tipi ",-1)),i(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.paymentType=a),class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[...t[20]||(t[20]=[e("option",{value:"monthly"},"Aylık",-1),e("option",{value:"yearly"},"Yıllık",-1)])],512),[[m,l.value.paymentType]])])]),e("div",Se,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Başlangıç Tarihi ",-1)),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.startDate=a),type:"date",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[w,l.value.startDate]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Bitiş Tarihi ",-1)),i(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.endDate=a),type:"date",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[w,l.value.endDate]])])]),e("div",null,[e("label",Ve,[i(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.isTrial=a),type:"checkbox",class:"w-4 h-4 text-primary-600 rounded"},null,512),[[F,l.value.isTrial]]),t[24]||(t[24]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Ücretsiz Deneme",-1))])]),l.value.isTrial?(n(),d("div",Ie,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Deneme Süresi (Gün) ",-1)),i(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>l.value.trialDays=a),type:"number",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"30"},null,512),[[w,l.value.trialDays,void 0,{number:!0}]])])):f("",!0),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Durum ",-1)),i(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>l.value.status=a),class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[...t[26]||(t[26]=[e("option",{value:"active"},"Aktif",-1),e("option",{value:"trial"},"Deneme",-1),e("option",{value:"expired"},"Süresi Dolmuş",-1),e("option",{value:"cancelled"},"İptal Edilmiş",-1)])],512),[[m,l.value.status]])])]),e("div",Ne,[e("button",{onClick:k,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," İptal "),e("button",{onClick:P,class:"px-4 py-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-lg hover:shadow-lg transition-all"},s(y.value?"Güncelle":"Oluştur"),1)])])])):f("",!0)]))}});export{Ee as default};
