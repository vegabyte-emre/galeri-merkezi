import{d as O,i as y,j as T,y as U,e as o,a,F as B,r as N,m as g,b as $,u as p,Q as E,o as s,n as f,h as q,t as u,c as x,f as Q,B as M}from"./BjtbWQxw.js";import{u as Y}from"./De5ev41G.js";import{u as G}from"./C6zue0OS.js";import{C as J}from"./CG46e6pd.js";import{c as K}from"./CHpBCNpF.js";import{T as P}from"./BmetU1Pa.js";import{B as z}from"./Y_Q2lfNL.js";import{C as W}from"./Bv2-sIXZ.js";import{M as X}from"./Cd_Kh4pK.js";import{U as Z}from"./CypFFH1h.js";const ee=K("CircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),re={class:"space-y-6"},te={class:"flex items-center gap-2 border-b border-gray-200 dark:border-gray-700"},ae=["onClick"],se={key:0,class:"ml-2 px-2 py-0.5 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400 rounded-full text-xs"},le={class:"space-y-3"},oe=["onClick"],ie={class:"flex items-start gap-4"},ne={class:"flex-1 min-w-0"},de={class:"flex items-start justify-between mb-1"},ce={class:"font-semibold text-gray-900 dark:text-white"},ue={key:0,class:"w-2 h-2 bg-primary-500 rounded-full flex-shrink-0 mt-2"},me={class:"text-sm text-gray-600 dark:text-gray-400 mb-2"},ge={class:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400"},ye={key:0},pe={key:1},fe={class:"flex items-center gap-2 flex-shrink-0"},be=["onClick"],ke=["onClick"],xe={key:0,class:"text-center py-12 bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700"},De=O({__name:"notifications",setup(he){const b=E(),m=Y(),n=G(),c=y("all"),h=y(!1),i=y(0),D=T(()=>[{label:"Tümü",value:"all",count:null},{label:"Okunmamış",value:"unread",count:i.value},{label:"Teklifler",value:"offer",count:null},{label:"Mesajlar",value:"message",count:null},{label:"Sistem",value:"system",count:null}]),l=y([]),j=e=>{switch(e){case"offer":return Z;case"message":return X;case"system":return W;default:return z}},A=e=>{switch(e){case"offer":return"bg-green-100 dark:bg-green-900/30";case"message":return"bg-blue-100 dark:bg-blue-900/30";case"system":return"bg-purple-100 dark:bg-purple-900/30";default:return"bg-gray-100 dark:bg-gray-900/30"}},I=e=>{switch(e){case"offer":return"text-green-600 dark:text-green-400";case"message":return"text-blue-600 dark:text-blue-400";case"system":return"text-purple-600 dark:text-purple-400";default:return"text-gray-600 dark:text-gray-400"}},v=T(()=>c.value==="all"?l.value:c.value==="unread"?l.value.filter(e=>!e.is_read):l.value.filter(e=>e.type===c.value)),S=async()=>{try{h.value=!0;const e=c.value==="unread"?"true":"false",t=await m.get(`/notifications?unread_only=${e}`);t.success&&t.data&&(l.value=t.data,i.value=t.unreadCount||0)}catch(e){n.error("Bildirimler yüklenemedi: "+e.message)}finally{h.value=!1}},H=e=>{const t=new Date(e),d=new Date().getTime()-t.getTime(),k=Math.floor(d/6e4),w=Math.floor(d/36e5),C=Math.floor(d/864e5);return k<1?"Az önce":k<60?`${k} dakika önce`:w<24?`${w} saat önce`:C<7?`${C} gün önce`:t.toLocaleDateString("tr-TR")},R=e=>{e.related_entity_type==="offer"&&e.related_entity_id?b.push("/offers"):e.related_entity_type==="message"&&e.related_entity_id?b.push("/chats"):e.related_entity_type==="vehicle"&&e.related_entity_id&&b.push("/vehicles"),e.is_read||_(e.id)},_=async e=>{const t=l.value.find(r=>r.id===e);if(t)try{await m.put(`/notifications/${e}/read`),t.is_read=!t.is_read,t.is_read?i.value=Math.max(0,i.value-1):i.value++}catch(r){n.error("Bildirim güncellenemedi: "+r.message)}},V=async e=>{if(confirm("Bu bildirimi silmek istediğinize emin misiniz?"))try{await m.delete(`/notifications/${e}`);const t=l.value.find(r=>r.id===e)?.is_read===!1;l.value=l.value.filter(r=>r.id!==e),t&&(i.value=Math.max(0,i.value-1)),n.success("Bildirim silindi")}catch(t){n.error("Hata: "+t.message)}},F=async()=>{try{await m.put("/notifications/read-all"),l.value.forEach(e=>{e.is_read=!0}),i.value=0,n.success("Tüm bildirimler okundu olarak işaretlendi")}catch(e){n.error("Hata: "+e.message)}},L=async()=>{if(confirm("Tüm bildirimleri silmek istediğinize emin misiniz?"))try{for(const e of l.value)await m.delete(`/notifications/${e.id}`);l.value=[],i.value=0,n.success("Tüm bildirimler silindi")}catch(e){n.error("Hata: "+e.message)}};return U(()=>{S()}),(e,t)=>(s(),o("div",re,[a("div",{class:"flex items-center justify-between"},[t[0]||(t[0]=a("div",null,[a("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Bildirimler"),a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Tüm bildirimlerinizi buradan yönetin")],-1)),a("div",{class:"flex items-center gap-3"},[a("button",{onClick:F,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-semibold"}," Tümünü Okundu İşaretle "),a("button",{onClick:L,class:"px-4 py-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors font-semibold"}," Tümünü Sil ")])]),a("div",te,[(s(!0),o(B,null,N(D.value,r=>(s(),o("button",{key:r.value,onClick:d=>c.value=r.value,class:f(["px-4 py-2 font-semibold text-sm border-b-2 transition-colors",c.value===r.value?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])},[q(u(r.label)+" ",1),r.count?(s(),o("span",se,u(r.count),1)):g("",!0)],10,ae))),128))]),a("div",le,[(s(!0),o(B,null,N(v.value,r=>(s(),o("div",{key:r.id,onClick:d=>R(r),class:f(["bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-4 hover:shadow-xl transition-all cursor-pointer",{"bg-primary-50 dark:bg-primary-900/20 border-primary-300 dark:border-primary-700":!r.is_read}])},[a("div",ie,[a("div",{class:f(["w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0",A(r.type)])},[(s(),x(Q(j(r.type)),{class:f(["w-6 h-6",I(r.type)])},null,8,["class"]))],2),a("div",ne,[a("div",de,[a("h3",ce,u(r.title),1),r.is_read?g("",!0):(s(),o("span",ue))]),a("p",me,u(r.message),1),a("div",ge,[a("span",null,u(H(r.created_at)),1),r.type?(s(),o("span",ye,"•")):g("",!0),r.type?(s(),o("span",pe,u(r.type),1)):g("",!0)])]),a("div",fe,[a("button",{onClick:M(d=>_(r.id),["stop"]),class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors"},[r.is_read?(s(),x(p(J),{key:0,class:"w-4 h-4"})):(s(),x(p(ee),{key:1,class:"w-4 h-4"}))],8,be),a("button",{onClick:M(d=>V(r.id),["stop"]),class:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400 transition-colors"},[$(p(P),{class:"w-4 h-4"})],8,ke)])])],10,oe))),128)),v.value.length===0?(s(),o("div",xe,[$(p(z),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t[1]||(t[1]=a("h3",{class:"text-lg font-bold text-gray-900 dark:text-white mb-2"},"Bildirim Yok",-1)),t[2]||(t[2]=a("p",{class:"text-gray-600 dark:text-gray-400"},"Henüz bildiriminiz bulunmuyor",-1))])):g("",!0)])]))}});export{De as default};
